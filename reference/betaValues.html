<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Peak shape quality: beta parameters — betaValues • MetaboCoreUtils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Peak shape quality: beta parameters — betaValues"><meta name="description" content="Calculate beta parameters for a chromatographic peak, both its similarity
to a bell curve of varying degrees of skew (i.e., assymmetry or
tailing factor) and the standard deviation of the residuals after the
best-fit bell is normalized and subtracted. This function
requires at least 5 scans or it will return NA for both parameters."><meta property="og:description" content="Calculate beta parameters for a chromatographic peak, both its similarity
to a bell curve of varying degrees of skew (i.e., assymmetry or
tailing factor) and the standard deviation of the residuals after the
best-fit bell is normalized and subtracted. This function
requires at least 5 scans or it will return NA for both parameters."><meta property="og:image" content="https://rformassspectrometry.github.io/MetaboCoreUtils/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MetaboCoreUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MetaboCoreUtils.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MetaboCoreUtils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Peak shape quality: beta parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MetaboCoreUtils/blob/main/R/peak-shape-quality.R" class="external-link"><code>R/peak-shape-quality.R</code></a></small>
      <div class="d-none name"><code>betaValues.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate <em>beta</em> parameters for a chromatographic peak, both its similarity
to a bell curve of varying degrees of skew (i.e., assymmetry or
<em>tailing factor</em>) and the standard deviation of the residuals after the
best-fit bell is normalized and subtracted. This function
requires at least 5 scans or it will return <code>NA</code> for both parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">betaValues</span><span class="op">(</span></span>
<span>  intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">intensity</span><span class="op">)</span>,</span>
<span>  skews <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3.5</span>, <span class="fl">4</span>, <span class="fl">4.5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  zero.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-intensity">intensity<a class="anchor" aria-label="anchor" href="#arg-intensity"></a></dt>
<dd><p>A <code>numeric</code> vector corresponding to the peak intensities
with a minimum length of 5.</p></dd>


<dt id="arg-rtime">rtime<a class="anchor" aria-label="anchor" href="#arg-rtime"></a></dt>
<dd><p>A numeric vector corresponding to the retention times of each
intensity. Retention times are expected to be in increasing order
without duplicates. If not provided, intensities will be assumed to be
equally spaced.</p></dd>


<dt id="arg-skews">skews<a class="anchor" aria-label="anchor" href="#arg-skews"></a></dt>
<dd><p>A <code>numeric</code> vector of the skews to try. These values will be
passed to <code>shape1</code> parameter of the <code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta()</a></code> function (with its
<code>shape2</code> parameter set to <code>5</code>). Values less than 5 will generated
increasingly right-skewed curves, while values greater than 5 will result
in left-skewed curves.
See <a href="https://link.springer.com/article/10.1186/s12859-023-05533-4/figures/8" class="external-link">Figure 8</a>
in the original manuscript for visual examples.</p></dd>


<dt id="arg-zero-rm">zero.rm<a class="anchor" aria-label="anchor" href="#arg-zero-rm"></a></dt>
<dd><p><code>logical(1)</code> controlling whether <em>missing</em> scans are dropped
prior to curve fitting. The default, <code>zero.rm = TRUE</code>, will remove
intensities of zero or <code>NA</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>numeric</code> of length 2.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function compares the actual chromatographic peak to <em>Beta</em> distribution
curves calculated with the <code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta()</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kumler W, Hazelton B J and Ingalls A E (2023) "Picky with peakpicking:
assessing chromatographic peak quality with simple metrics in metabolomics"
<em>BMC Bioinformatics</em> 24(1):404.
doi: <a href="https://doi.org/10.1186/s12859-023-05533-4" class="external-link">10.1186/s12859-023-05533-4</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta()</a></code> for the function to calculate the Beta distribution.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>William Kumler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define intensity values of a typical chromatographic peak</span></span></span>
<span class="r-in"><span><span class="va">skinny_peak</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9107</span>, <span class="fl">3326</span>, <span class="fl">9523</span>, <span class="fl">3245</span>, <span class="fl">3429</span>, <span class="fl">9394</span>, <span class="fl">1123</span>, <span class="fl">935</span>, <span class="fl">5128</span>, <span class="fl">8576</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">2711</span>, <span class="fl">3427</span>, <span class="fl">7294</span>, <span class="fl">8109</span>, <span class="fl">9288</span>, <span class="fl">6997</span>, <span class="fl">9756</span>, <span class="fl">8034</span>, <span class="fl">1317</span>, <span class="fl">8866</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">13877</span>, <span class="fl">14854</span>, <span class="fl">28296</span>, <span class="fl">57101</span>, <span class="fl">92209</span>, <span class="fl">151797</span>, <span class="fl">222386</span>, <span class="fl">299402</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">365045</span>, <span class="fl">394255</span>, <span class="fl">402680</span>, <span class="fl">363996</span>, <span class="fl">293985</span>, <span class="fl">222989</span>, <span class="fl">147007</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">94947</span>, <span class="fl">52924</span>, <span class="fl">32438</span>, <span class="fl">11511</span>, <span class="fl">10836</span>, <span class="fl">8046</span>, <span class="fl">601</span>, <span class="fl">889</span>, <span class="fl">5917</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">2690</span>, <span class="fl">5381</span>, <span class="fl">9901</span>, <span class="fl">8494</span>, <span class="fl">3349</span>, <span class="fl">8283</span>, <span class="fl">3410</span>, <span class="fl">5935</span>, <span class="fl">3332</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">7041</span>, <span class="fl">3284</span>, <span class="fl">7478</span>, <span class="fl">76</span>, <span class="fl">3739</span>, <span class="fl">2158</span>, <span class="fl">5507</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">skinny_peak_rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">skinny_peak</span><span class="op">)</span><span class="op">+</span><span class="fl">100</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">skinny_peak_rt</span>, <span class="va">skinny_peak</span>, xlab <span class="op">=</span> <span class="st">"RT"</span>,</span></span>
<span class="r-in"><span>    ylab <span class="op">=</span> <span class="st">"intensity"</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betaValues-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate beta parameters for the full region including noise signal</span></span></span>
<span class="r-in"><span><span class="co">## around the peak</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">betaValues</span><span class="op">(</span><span class="va">skinny_peak</span>, <span class="va">skinny_peak_rt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> best_cor beta_snr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.727437 6.789728 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate beta parameters for peak signal</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">betaValues</span><span class="op">(</span><span class="va">skinny_peak</span><span class="op">[</span><span class="fl">20</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span>, <span class="va">skinny_peak_rt</span><span class="op">[</span><span class="fl">20</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  best_cor  beta_snr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9858619 7.1275735 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define noisy chromatographic signal</span></span></span>
<span class="r-in"><span><span class="va">noise_peak</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.288</span>, <span class="fl">0.788</span>, <span class="fl">0.409</span>, <span class="fl">0.883</span>, <span class="fl">0.94</span>, <span class="fl">0.046</span>, <span class="fl">0.528</span>, <span class="fl">0.892</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.551</span>, <span class="fl">0.457</span>, <span class="fl">0.957</span>, <span class="fl">0.453</span>, <span class="fl">0.678</span>, <span class="fl">0.573</span>, <span class="fl">0.103</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.246</span>, <span class="fl">0.042</span>, <span class="fl">0.328</span>, <span class="fl">0.955</span>, <span class="fl">0.89</span>, <span class="fl">0.693</span>, <span class="fl">0.641</span>, <span class="fl">0.994</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.656</span>, <span class="fl">0.709</span>, <span class="fl">0.544</span>, <span class="fl">0.594</span>, <span class="fl">0.289</span>, <span class="fl">0.147</span>, <span class="fl">0.963</span>, <span class="fl">0.902</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.691</span>, <span class="fl">0.795</span>, <span class="fl">0.025</span>, <span class="fl">0.478</span>, <span class="fl">0.758</span>, <span class="fl">0.216</span>, <span class="fl">0.318</span>, <span class="fl">0.232</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.143</span>, <span class="fl">0.415</span>, <span class="fl">0.414</span>, <span class="fl">0.369</span>, <span class="fl">0.152</span>, <span class="fl">0.139</span>, <span class="fl">0.233</span>, <span class="fl">0.466</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.266</span>, <span class="fl">0.858</span>, <span class="fl">0.046</span>, <span class="fl">0.442</span>, <span class="fl">0.799</span>, <span class="fl">0.122</span>, <span class="fl">0.561</span>, <span class="fl">0.207</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.128</span>, <span class="fl">0.753</span>, <span class="fl">0.895</span>, <span class="fl">0.374</span>, <span class="fl">0.665</span>, <span class="fl">0.095</span>, <span class="fl">0.384</span>, <span class="fl">0.274</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.815</span>, <span class="fl">0.449</span>, <span class="fl">0.81</span>, <span class="fl">0.812</span>, <span class="fl">0.794</span>, <span class="fl">0.44</span>, <span class="fl">0.754</span>, <span class="fl">0.629</span>, <span class="fl">0.71</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.001</span>, <span class="fl">0.475</span>, <span class="fl">0.22</span>, <span class="fl">0.38</span>, <span class="fl">0.613</span>, <span class="fl">0.352</span>, <span class="fl">0.111</span>, <span class="fl">0.244</span>, <span class="fl">0.668</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.418</span>, <span class="fl">0.788</span>, <span class="fl">0.103</span>, <span class="fl">0.435</span>, <span class="fl">0.985</span>, <span class="fl">0.893</span>, <span class="fl">0.886</span>, <span class="fl">0.175</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.131</span>, <span class="fl">0.653</span>, <span class="fl">0.344</span>, <span class="fl">0.657</span>, <span class="fl">0.32</span>, <span class="fl">0.188</span>, <span class="fl">0.782</span>, <span class="fl">0.094</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.467</span>, <span class="fl">0.512</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">noise_peak_rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">noise_peak</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">betaValues</span><span class="op">(</span><span class="va">noise_peak</span>, <span class="va">noise_peak_rt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    best_cor    beta_snr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.03291661  0.39695171 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Rainer, Michael Witting, Andrea Vicini, Sebastian Gibb, Roger Gine, William Kumler, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

